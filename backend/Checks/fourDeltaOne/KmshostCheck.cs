using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace fdocheck.Checks
{
    class KmshostCheck : BasicCheck
    {
        public bool KmshostOnline { get; set; }
        public string KmshostServerHost = "a.fourdeltaone.net";
        public int KmshostServerPort = 1688;

        private readonly byte[] KmshostTestPacket = /*
00000000                                       05 00 0b 13              ....
00000010  10 00 00 00 74 00 00 00  02 00 00 00 d0 16 d0 16 ....t... ........
00000020  00 00 00 00 02 00 00 00  00 00 01 00 75 21 c8 51 ........ ....u!.Q
00000030  4e 84 50 47 b0 d8 ec 25  55 55 bc 06 01 00 00 00 N.PG...% UU......
00000040  04 5d 88 8a eb 1c c9 11  9f e8 08 00 2b 10 48 60 .]...... ....+.H`
00000050  02 00 00 00 01 00 01 00  75 21 c8 51 4e 84 50 47 ........ u!.QN.PG
00000060  b0 d8 ec 25 55 55 bc 06  01 00 00 00 2c 1c b7 6c ...%UU.. ....,..l
00000070  12 98 40 45 03 00 00 00  00 00 00 00 01 00 00 00 ..@E.... ........

            I'm too silly to understand captured packages. ._.
                                                     */
            new byte[] {
                0x05, 0x00, 0x0b, 0x13,
                0x10, 0x00, 0x00, 0x00, 0x74, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00, 0xd0, 0x16, 0xd0, 0x16,
                0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x75, 0x21, 0xc8, 0x51,
                0x4e, 0x84, 0x50, 0x47, 0xb0, 0xd8, 0xec, 0x25, 0x55, 0x55, 0xbc, 0x06, 0x01, 0x00, 0x00, 0x00,
                0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
                0x02, 0x00, 0x00, 0x00, 0x01, 0x00, 0x01, 0x00, 0x75, 0x21, 0xc8, 0x51, 0x4e, 0x84, 0x50, 0x47,
                0xb0, 0xd8, 0xec, 0x25, 0x55, 0x55, 0xbc, 0x06, 0x01, 0x00, 0x00, 0x00, 0x2c, 0x1c, 0xb7, 0x6c,
                0x12, 0x98, 0x40, 0x45, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00
            };

        public void CheckKmshost()
        {
            if (!NeedToUpdate("kmshost", 300))
                return;

            KmshostOnline = TcpCheck(KmshostTestPacket, KmshostServerHost, KmshostServerPort);
        }
    }
}
